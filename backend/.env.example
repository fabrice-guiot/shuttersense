# Database Configuration
# PostgreSQL connection string
# Format: postgresql://username:password@host:port/database
SHUSAI_DB_URL=postgresql://user:password@localhost:5432/shuttersense

# Master Encryption Key (REQUIRED)
# Generate using: python setup_master_key.py
# This key encrypts remote storage credentials in the database
SHUSAI_MASTER_KEY=

# Optional: Override default cache TTL (seconds) per collection state
# COLLECTION_CACHE_TTL_LIVE=3600
# COLLECTION_CACHE_TTL_CLOSED=86400
# COLLECTION_CACHE_TTL_ARCHIVED=604800

# Optional: Server Configuration
# SERVER_HOST=0.0.0.0
# SERVER_PORT=8000
# SERVER_RELOAD=true

# Optional: CORS Configuration (for frontend dev server)
# CORS_ORIGINS=http://localhost:3000,http://localhost:5173

# Optional: Public API Documentation (Issue #159)
# Base URL for the public API, used in the filtered OpenAPI spec "servers" field.
# When set, /public/api/docs and /public/api/redoc serve documentation pointing
# to this URL. Nginx rewrites remove the /api/ prefix on this hostname.
# SHUSAI_PUBLIC_API_BASE_URL=https://api.shuttersense.ai

# Documentation site URL, automatically added to CORS allowed origins so that
# Swagger UI "Try it out" on docs.shuttersense.ai can call api.shuttersense.ai.
# SHUSAI_DOCS_SITE_URL=https://docs.shuttersense.ai

# Optional: Logging Configuration
# SHUSAI_LOG_LEVEL=INFO
# SHUSAI_LOG_DIR=logs
# SHUSAI_ENV=development

# Optional: Local Collection Security
# Comma-separated list of authorized root paths for local collections
# SHUSAI_AUTHORIZED_LOCAL_ROOTS=/photos,/media,~/Pictures

# Optional: SPA Distribution Path
# SHUSAI_SPA_DIST_PATH=frontend/dist

# =============================================================================
# OAuth 2.0 Authentication (Required for user login)
# =============================================================================

# Google OAuth (https://console.cloud.google.com/apis/credentials)
# 1. Create OAuth 2.0 Client ID (Web application type)
# 2. Add authorized redirect URI: http://localhost:8000/auth/callback/google
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=

# Microsoft OAuth (https://portal.azure.com/#view/Microsoft_AAD_RegisteredApps)
# 1. Register new application
# 2. Add redirect URI: http://localhost:8000/auth/callback/microsoft
# 3. Create client secret under "Certificates & secrets"
MICROSOFT_CLIENT_ID=
MICROSOFT_CLIENT_SECRET=

# Base URL for OAuth redirects (no trailing slash)
# OAUTH_REDIRECT_BASE_URL=http://localhost:8000

# =============================================================================
# Session Configuration
# =============================================================================

# Secret key for signing session cookies (REQUIRED for auth)
# Generate using: python -c "import secrets; print(secrets.token_urlsafe(32))"
SESSION_SECRET_KEY=

# Session duration in seconds (default: 86400 = 24 hours)
# SESSION_MAX_AGE=86400

# Cookie security settings
# SESSION_HTTPS_ONLY=false  # Set to true in production
# SESSION_SAME_SITE=lax

# =============================================================================
# JWT API Token Configuration
# =============================================================================

# Secret key for signing API tokens (REQUIRED for API token feature)
# Generate using: python -c "import secrets; print(secrets.token_urlsafe(32))"
# IMPORTANT: Use a DIFFERENT key from SESSION_SECRET_KEY
JWT_SECRET_KEY=

# JWT algorithm (default: HS256)
# JWT_ALGORITHM=HS256

# Default API token expiration in days (default: 90)
# API_TOKEN_DEFAULT_EXPIRY_DAYS=90


# =============================================================================
# Security Settings
# =============================================================================

# Rate limiting storage backend (default: memory://)
# "memory://" is fine for single-process deployments (uvicorn with 1 worker).
# For multi-worker (uvicorn --workers N) or multi-instance deployments,
# use a shared backend so rate limits are enforced globally:
#   redis://localhost:6379        - Redis (recommended)
#   memcached://localhost:11211   - Memcached
#   redis+sentinel://host:26379   - Redis Sentinel (HA)
# NOTE: Redis backend requires: pip install redis
# RATE_LIMIT_STORAGE_URI=memory://

# Agent binary attestation (Issue #236)
# Enforced by default â€” agents must have a verified binary checksum
# (matching a release manifest) to claim jobs and upload results.
# Set to false ONLY in development where agents run from source.
# SHUSAI_REQUIRE_AGENT_ATTESTATION=false

# Super admin email hashes (comma-separated SHA-256 hex digests)
# Generate a hash: python -c "import hashlib; print(hashlib.sha256('admin@example.com'.lower().encode()).hexdigest())"
# SHUSAI_SUPER_ADMIN_HASHES=hash1,hash2

# =============================================================================
# GeoIP Geofencing (Optional)
# =============================================================================

# Country-based access control using MaxMind GeoLite2-Country database.
# Download from: https://dev.maxmind.com/geoip/geolite2-free-geolocation-data
# Requires a free MaxMind account.
#
# When enabled, only requests from listed countries are allowed.
# Private/loopback IPs always bypass geofencing. /health is always exempt.

# Path to MaxMind GeoLite2-Country .mmdb database file (empty = disabled)
# SHUSAI_GEOIP_DB_PATH=/opt/geoip/GeoLite2-Country.mmdb

# Comma-separated ISO 3166-1 alpha-2 country codes
# WARNING: An empty list with a configured DB path will block ALL non-private requests
# SHUSAI_GEOIP_ALLOWED_COUNTRIES=US,CA

# If true, allow requests when GeoIP lookup returns no country (default: false = block unknown)
# SHUSAI_GEOIP_FAIL_OPEN=false

# =============================================================================
# Agent Binary Distribution (Optional)
# =============================================================================

# Absolute path to the directory containing agent binaries for download.
# Directory structure: {SHUSAI_AGENT_DIST_DIR}/{version}/{filename}
# Example: /opt/shuttersense/agent-dist/1.0.0/shuttersense-agent-darwin-arm64
#
# When set, the Agent Setup Wizard enables binary downloads via authenticated
# endpoints (session cookie or HMAC-signed URLs).
#
# When not set (default), the wizard operates in dev/QA mode:
# all platforms are shown but download buttons are disabled.
# SHUSAI_AGENT_DIST_DIR=/opt/shuttersense/agent-dist

# =============================================================================
# Job Queue Configuration
# =============================================================================

# Comma-separated list of tool types to run in-memory on the server
# By default (empty), ALL jobs are persisted to the database and executed by agents
# Only use this for development/testing when no agents are available
#
# Available tool types: photostats, photo_pairing, pipeline_validation
#
# Examples:
#   INMEMORY_JOB_TYPES=photostats              # Only photostats runs on server
#   INMEMORY_JOB_TYPES=photostats,photo_pairing # Multiple tools on server
#   INMEMORY_JOB_TYPES=                         # All jobs go to agents (default)
#
# WARNING: In-memory jobs run on the API server and may impact performance.
# For production, leave empty and use distributed agents instead.
# INMEMORY_JOB_TYPES=

# =============================================================================
# Web Push Notifications (VAPID)
# =============================================================================

# VAPID keys for Web Push notification delivery (Issue #114)
# Generate using: python -c "from py_vapid import Vapid; v = Vapid(); v.generate_keys(); print('Public:', v.public_key); print('Private:', v.private_key)"
# Or use: npx web-push generate-vapid-keys
VAPID_PUBLIC_KEY=
VAPID_PRIVATE_KEY=

# VAPID subject identifier (mailto: or https: URL)
# Must match the domain or contact email of the push sender
VAPID_SUBJECT=mailto:admin@shuttersense.ai