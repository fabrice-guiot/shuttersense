# Photo Statistics Configuration Template
# Copy this file to config.yaml and customize it for your needs
#
# This file defines:
# 1. Which file types are considered photo/image files
# 2. Which file types REQUIRE XMP sidecar files
# 3. What metadata sidecar extensions are valid

# File types that should be scanned
# All extensions listed here will be counted in statistics
photo_extensions:
  - .dng      # DNG files (already contain metadata, no sidecar needed)
  - .tiff     # TIFF files (already contain metadata, no sidecar needed)
  - .tif      # TIFF files (already contain metadata, no sidecar needed)
  - .cr3      # Canon CR3 RAW (requires XMP sidecar)
  # Uncomment or add additional formats as needed:
  # - .nef     # Nikon RAW (requires XMP sidecar)
  # - .arw     # Sony RAW (requires XMP sidecar)
  # - .orf     # Olympus RAW (requires XMP sidecar)
  # - .rw2     # Panasonic RAW (requires XMP sidecar)
  # - .pef     # Pentax RAW (requires XMP sidecar)
  # - .raf     # Fujifilm RAW (requires XMP sidecar)
  # - .raw     # Generic RAW (requires XMP sidecar)
  # - .crw     # Canon RAW older (requires XMP sidecar)
  # - .cr2     # Canon RAW (requires XMP sidecar)
  # - .jpg     # JPEG (may or may not need sidecar)
  # - .jpeg    # JPEG (may or may not need sidecar)

# File types that REQUIRE XMP sidecar files
# Only these will be flagged as "orphaned" if they don't have a matching .xmp file
# Note: DNG and TIFF typically embed metadata, so they don't need sidecars
require_sidecar:
  - .cr3
  # Uncomment formats that require sidecars in your workflow:
  # - .nef
  # - .arw
  # - .orf
  # - .rw2
  # - .pef
  # - .raf
  # - .raw
  # - .crw
  # - .cr2

# Valid metadata sidecar file extensions
metadata_extensions:
  - .xmp

# Camera ID mappings for Photo Pairing Tool
# Maps 4-character camera IDs to camera information
# Structure: camera_id -> list of cameras (v1.0 uses first entry only)
camera_mappings:
  # Example entries (will be populated automatically on first run):
  # AB3D:
  #   - name: "Canon EOS R5"
  #     serial_number: "12345"
  # XYZW:
  #   - name: "Sony A7IV"
  #     serial_number: ""

# Processing method descriptions for Photo Pairing Tool
# Maps processing method keywords found in filenames to descriptions
processing_methods:
  # Example entries (will be populated automatically on first run):
  # "HDR": "High Dynamic Range processing"
  # "BW": "Black and white conversion"
  # "PANO": "Panorama stitching"
  # Processing methods used in pipeline validation (add suffixes to filenames):
  "DxO_DeepPRIME_XD2s": "DNG Conversion with DxO DeepPRIME XD2s"
  "Edit": "Photoshop Editing"

# Pipeline Validation Tool Configuration
# Defines expected photo processing workflows as directed graphs
# Used by pipeline_validation.py to validate file completeness
processing_pipelines:
  nodes:
    # --- CAPTURE NODE (Starting Point) ---
    - id: "capture"
      type: "Capture"
      name: "Camera Capture"
      output: ["raw_image_1", "xmp_metadata_1"]

    # --- FILE NODES (Expected Files) ---
    - id: "raw_image_1"
      type: "File"
      extension: ".CR3"
      name: "Canon Raw File"
      output: ["selection_process"]

    - id: "xmp_metadata_1"
      type: "File"
      extension: ".XMP"
      name: "XMP Metadata Sidecar"
      output: []  # Terminal file node (always present)

    # --- PROCESS NODES (Editing/Conversion Steps) ---
    - id: "selection_process"
      type: "Process"
      method_ids: [""]  # Empty string means no suffix added (selection only)
      name: "Image Selection"
      output: ["dng_conversion"]

    - id: "dng_conversion"
      type: "Process"
      method_ids: ["DxO_DeepPRIME_XD2s"]  # Adds "-DxO_DeepPRIME_XD2s" suffix
      name: "DNG Conversion with DeepPRIME"
      output: ["openformat_raw_image", "xmp_metadata_2"]

    - id: "openformat_raw_image"
      type: "File"
      extension: ".DNG"
      name: "Open Format Raw (DNG)"
      output: ["individual_photoshop_process"]

    - id: "xmp_metadata_2"
      type: "File"
      extension: ".XMP"
      name: "DNG Metadata Sidecar"
      output: []

    - id: "individual_photoshop_process"
      type: "Process"
      method_ids: ["Edit"]  # Adds "-Edit" suffix (can loop: -Edit-Edit-Edit...)
      name: "Photoshop Editing"
      output: ["tiff_generation_branching"]

    # --- BRANCHING NODE (Conditional Path) ---
    - id: "tiff_generation_branching"
      type: "Branching"
      condition_description: "User decides: Create final TIFF or continue editing"
      name: "TIFF Generation Decision"
      output: ["generate_tiff_process", "individual_photoshop_process"]  # Second output creates loop

    - id: "generate_tiff_process"
      type: "Process"
      method_ids: [""]  # No suffix (TIFF generation preserves filename)
      name: "Generate Final TIFF"
      output: ["tiff_image"]

    - id: "tiff_image"
      type: "File"
      extension: ".TIF"
      name: "Final TIFF File"
      output: ["termination_blackbox"]

    # --- TERMINATION NODE (Archival Ready) ---
    - id: "termination_blackbox"
      type: "Termination"
      termination_type: "Black Box Archive"
      name: "Black Box Archive Ready"
      output: []  # Termination nodes have no outputs

# Notes on Pipeline Validation:
# 1. Validation enumerates ALL paths from Capture to Termination nodes
# 2. Branching nodes explore ALL branches (not just one)
# 3. Loops are limited to 5 iterations per Process node (prevents infinite paths)
# 4. Files are classified as:
#    - CONSISTENT: All expected files present, no extra files
#    - CONSISTENT-WITH-WARNING: All expected files present, but extra files exist
#    - PARTIAL: Some expected files missing
#    - INCONSISTENT: No matching paths (completely wrong files)
# 5. For complex workflows, see docs/pipeline-validation.md
